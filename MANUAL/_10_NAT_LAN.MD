# NAT + LAN

### Порядок действий

Чтобы организовать доступ в интернет и при этом общаться с другими виртуальными машинами нам понадобится сделать это через два сетевых адаптера

При создании виртуальной машины создается один адаптер и работает он в режиме NAT

<img src="src\img\_10_NAT_LAN\1.png" width="600px"></img>

Нам необходимо добавить еще один адаптер. Для этого заходим в настройки VM и нажимаем кнопку `ADD`

<img src="src\img\_10_NAT_LAN\2.png" width="600px"></img>

После в открывшемся окне ищем `Network Adapter`

<img src="src\img\_10_NAT_LAN\4.png" width="600px"></img>

После чего у нас появится второй сетевой адаптер. Перейдем к его настройке. Выберим режим работы `LAN segment` и создадим новый сегмент в который будем добавлять все виртуальные машины, которые хотим связать

<img src="src\img\_10_NAT_LAN\5.png" width="600px"></img>

<img src="src\img\_10_NAT_LAN\6.png" width="600px"></img>

<img src="src\img\_10_NAT_LAN\7.png" width="600px"></img>

После создания в выпадающем меню выбираем созданный нами сегмент

<img src="src\img\_10_NAT_LAN\8.png" width="700px"></img>

> По аналогии провести все операции для других VM

# Настройка ip-адресов на Linux

Для начала просмотрим название интерфейса:

```sh
ip a
```

<img src="src\img\_10_NAT_LAN\9.png" width="700px"></img>

В данном случае называются `ens33` и `ens37`

> Если при добавлении адаптера LAN, NAT стоял первый по списку, значит ens33 - NAT

Заходим в файл конфигурации для настройки интерфейса

```sh
nano /etc/netplan/00-installer-config.yaml
```

> Название файла может отличатся

<img src="src\img\_10_NAT_LAN\10.png" width="700px"></img>

ens33 - NAT получает сетевые реквизиты от гипервизова, поэтому мы ему выдаем DHCP для авто выдачи

ens37 - LAN указываем айпи из выбраной нами подсети